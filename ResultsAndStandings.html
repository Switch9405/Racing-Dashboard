<!DOCTYPE html>
<html lang="en">
<head> 
  <meta charset="UTF-8"/> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/> 
  <title>MidLapCrisis - Results & Standings</title>         
  <link rel="stylesheet" href="00 - Style.css"/>
  <link rel="stylesheet" href="03 - Results and Standings.css"/>  
  <link rel="preconnect" href="https://fonts.googleapis.com"/> 
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;700;900&display=swap" rel="stylesheet">
</head>
<body class="content">
  <div class="nav-container">
    <nav>
      <a href="index.html" class="nav-title">
        <span class="Logo-title-main" style="color: var(--white)">MidLapCrisis</span>
        <span class="Logo-title-sub" style="color: var(--accent); font-weight: normal">RACING LEAGUE</span>
      </a>
      <a href="index.html">The Pit Wall</a> 
      <a href="RaceCalendar.html">Race Calendar</a>   
      <a href="ResultsAndStandings.html" class="active">Results & Standings</a>      
      <a href="Teams.html">Teams</a>
      <a href="Drivers.html">Drivers</a>
      <a href="SportingCode.html">Sporting Code</a>
      <button class="menu-toggle" aria-label="Toggle Menu">☰</button>
    </nav>             
  </div>

  <div class="page-container">
    <h1>Results & Standings</h1> 
    <div class="mb-h2-title">Season 2</div>  

    <div class="mb-grid-container">

      <!-- TAB HEADERS + SEASON SELECT -->
      <div class="tab-buttons">
        <button class="tab-button tab-button-drivers active" data-value="drivers">DRIVER CHAMPIONSHIP</button>
        <button class="tab-button tab-button-teams" data-value="teams">TEAM CHAMPIONSHIP</button>
        <button class="tab-button tab-button-race" data-value="results">RACE RESULTS</button>
        <label for="season-select" style="margin-right: 6px; font-weight: 500;">Select Season:</label>
        <select id="season-select">
          <option value="Active">Season 2</option>
          <option value="Season 1">Season 1</option>
          </select>
      </div>  

      <!-- DRIVER TABLE -->
      <div id="drivers-table-container" class="table-container">
        <div id="loading-spinner-drivers" class="mb-spinner-container">
          <div class="mb-spinner"></div>
          <p>Loading driver standings…</p>
        </div>
        <table id="dc-points-table"> 
          <thead><tr></tr></thead>
          <tbody></tbody>
        </table> 
      </div>

      <!-- TEAM TABLE -->
      <div id="team-table-container" class="table-container" style="display: none;">
        <div id="loading-spinner-teams" class="mb-spinner-container">
          <div class="mb-spinner"></div>
          <p>Loading team standings…</p>
        </div>
        <table id="tc-points-table"> 
          <thead><tr></tr></thead>
          <tbody></tbody>
        </table> 
      </div>

      <!-- RACE RESULTS TABLE -->
      <div id="results-table-container" class="table-container" style="display: none;"></div>
    </div>
  </div>

  <!-- Season Manager -->
  <script src="00 - SeasonManager.js"></script>

  <!-- Loaders -->
  <script type="module">
    import { loadDriverData } from './03a - DriversChampionshipTable.js';
    import { loadTeamData } from './03b - TeamsChampionshipTable.js';
    import { loadRaceResults } from './03c - Race Results.js';

    function loadAll() {
      loadDriverData();
      loadTeamData();
      loadRaceResults();
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Set initial season text
      document.querySelectorAll('.season-text').forEach(el => {
        el.textContent = SeasonManager.getSeason();
      });

      // Set dropdown to current season
      const seasonSelect = document.getElementById('season-select');
      seasonSelect.value = SeasonManager.getSeason();

      // Initial load
      loadAll();

      // Handle dropdown change
      seasonSelect.addEventListener('change', () => {
        SeasonManager.setSeason(seasonSelect.value);
        loadAll();
      });
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const buttons = document.querySelectorAll('.tab-button');
      const tables = {
        drivers: document.getElementById("drivers-table-container"),
        teams: document.getElementById("team-table-container"),
        results: document.getElementById("results-table-container")
      };

      buttons.forEach(button => {
        button.addEventListener('click', () => {
          buttons.forEach(btn => btn.classList.remove('active'));
          button.classList.add('active');

          const value = button.getAttribute('data-value');
          Object.entries(tables).forEach(([key, el]) => {
            el.style.display = key === value ? 'block' : 'none';
          });
        });
      });
    });
  </script>

  <script>
    const menuToggle = document.querySelector('.menu-toggle');
    const nav = document.querySelector('nav');
    menuToggle.addEventListener('click', () => {
      nav.classList.toggle('active');
    });
  </script>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-container">
      <div class="row">
        <div class="footer-col">
          <h4>The Team</h4>
          <ul>
            <li><a href="https://steamcommunity.com/profiles/76561198054944564">Switch</a></li>
            <li><a href="https://steamcommunity.com/profiles/76561198862914841">Teeds</a></li>
            <li><a href="https://steamcommunity.com/id/dutchZA">Dutch</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>FAQs</h4>
          <ul>
            <li><a href="https://store.steampowered.com/app/1097130/Circuit_Superstars/">Where do I purchase Circuit Superstars?</a></li>
            <li><a href="https://docs.google.com/forms/d/e/1FAIpQLSciRonlcIrKZ8TC1ulOfpK0pN8sGZpeYMGLtQPdlZ0iLCrJ4Q/viewform?usp=dialog">How do I join the league?</a></li>
            <li><a href="05 - Sporting Code.html">Does the league have rules?</a></li>
          </ul>
        </div>
        <div style="margin-left: auto;" class="footer-col">
          <h4>MidLapCrisis Racing League</h4>
          <ul>
            <h3>© 2025 MidLapCrisis Racing League. All rights reserved.</h3>
          </ul>
        </div>
      </div>
    </div>
  </footer>
</body>
</html>
